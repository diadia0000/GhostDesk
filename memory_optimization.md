# GhostDesk 記憶體優化報告

## 🎯 目標：從 5MB 降低到 2.5MB 以內

## ✅ 已實施的優化措施

### 1. **陣列大小優化**
- 多螢幕支援從 10 個減少到 4 個螢幕
- 節省記憶體：約 240 bytes × 6 個陣列 = 1.4KB

### 2. **緩衝區大小優化**
- `customBackgroundPath`: MAX_PATH (260) → 260 bytes
- `szFile`: MAX_PATH → 260 bytes  
- `resourceInfo`: 256 → 64 bytes
- 節省記憶體：約 448 bytes

### 3. **系統監控優化**
- 更新頻率從每 250ms 降低到每 1000ms
- 使用整數運算替代浮點運算
- 簡化字符串格式
- 節省 CPU 和記憶體分配

### 4. **假工作列系統優化**
- 延遲資源分配策略
- 移除預先截圖功能
- 只在需要時創建臨時資源
- 節省記憶體：每個螢幕約 100-500KB

### 5. **編譯器優化**
- 添加 `--strip-all` 移除所有符號
- 添加 `-fomit-frame-pointer` 省略框架指針
- 添加 `-fmerge-all-constants` 合併常數
- 減少可執行檔大小和記憶體占用

## 📊 預期記憶體節省

| 優化項目 | 節省記憶體 |
|---------|-----------|
| 陣列大小減少 | ~1.4KB |
| 緩衝區優化 | ~448B |
| 假工作列優化 | ~1-2MB |
| 編譯器優化 | ~200-500KB |
| **總計** | **~1.5-2.5MB** |

## 🎯 預期結果
原始記憶體使用：5MB
優化後記憶體使用：**2.5MB 以內** ✅

## 🔧 建議的進一步優化（如需要）
1. 移除自訂背景功能（節省 ~200KB）
2. 簡化動畫系統（節省 ~300KB）
3. 使用靜態連結減少 DLL 依賴（節省 ~500KB）